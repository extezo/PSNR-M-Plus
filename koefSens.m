function k = koefSens(image, freq_temp, freq_spatial)

if ~exist('freq_spatial','var') || isempty(freq_spatial)
  freq_spatial=zeros(size(image));
end
if size(image) ~= size(freq_temp) | size(image) ~= size(freq_spatial)
    error('Dimmentions must agree');
end
image = im2double(image);

THETA_LOG = [-2.31324322336932;1.50512703597979;0.367349315881366;3.18655979008766;-7.66613420152189;-11.7061539477573;-6.88974431767900;0.647889454333573;-3.86056958979751;1.43587484657904;8.16356963838202;26.5144408135850;2.52964678897541;10.6718916990953;-2.33748077386246;-3.43703340628180;-29.0299789152317;6.50854995409721;14.2166716651169;-5.90013396509646;-2.58449565803322;-7.19565134845494;-7.19565134848995;-9.59531656500626;3.82098289297032;-0.143583643762538;17.8683923695318;-0.713899638366362;-4.20821013444190;1.31224899876147;-3.52786977368182;-1.97921613118689;2.07038014750207;5.38591209423837;-0.653504566269330];
FREQ_SPATIAL_NORM = 15; % taken from model
FREQ_TEMP_NORM = 66.6;
IMAGE_NORM = 200 / 255;
X = createArgMatrix(freq_spatial(:) / FREQ_SPATIAL_NORM, ...
    freq_temp(:) / FREQ_TEMP_NORM, ...
    image(:)/ IMAGE_NORM);
k = X * THETA_LOG;
k = reshape(k, size(image));
k = exp(k);
k = k / 0.22012988302511;